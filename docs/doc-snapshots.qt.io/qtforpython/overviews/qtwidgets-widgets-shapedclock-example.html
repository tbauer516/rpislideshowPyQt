
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Shaped Clock Example &#8212; Qt for Python (Technology Preview)</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.11.0~a1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="search" title="Search" href="../search.html" />
  <link rel="stylesheet" type="text/css" href="/style/pyside.css" />
  <link rel="icon" type="image/png" href="/style/pyside-32px.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="/style/pyside-16px.png" sizes="16x16" />
  <script type="text/javascript"> wpThemeFolder = 'http://qt.io/wp-content/themes/oneqt'; </script>
  <script type="text/javascript" src="/scripts/main.js"></script>
  <script type="text/javascript" src="/scripts/extras.js"></script>
  <script type="text/javascript">
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-54043535-2', 'qt.io');
    ga('set', 'forceSSL', true);
    ga('send', 'pageview');
  </script>

  </head>
  <body>
<div id="container">
    <div class="header">
        <div class="header_container">
            <header id="navbar">
            </header>
        </div>
    </div>
    <div class="main">
        <div class="main-rounded">
            <div class="navigationbar">
                <ul class="sub-navigation">
                    <li><a href="http://wiki.qt.io/">Wiki</a></li>
                    <li><a href="https://doc.qt.io/">Documentation</a></li>
                    <li><a href="http://forum.qt.io/">Forum</a></li>
                    <li><a href="https://bugreports.qt.io/">Bug Reports</a></li>
                    <li><a href="https://codereview.qt-project.org/">Code Review</a></li>
                </ul>
                <div id="main_title_bar"><h1>Qt Documentation</h1></div>
                <div class="related">
                    <ul>
                        <li><a href="../index.html">Qt for Python (Technology Preview)</a></li> 
                    </ul>
                </div>
            </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Shaped Clock Example</a><ul>
<li><a class="reference internal" href="#shapedclock-class-definition">ShapedClock Class Definition</a></li>
<li><a class="reference internal" href="#shapedclock-class-implementation">ShapedClock Class Implementation</a></li>
<li><a class="reference internal" href="#notes-on-widget-masks">Notes on Widget Masks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shapedclock-cpp-example-file">shapedclock.cpp Example File</a></li>
<li><a class="reference internal" href="#shapedclock-h-example-file">shapedclock.h Example File</a></li>
<li><a class="reference internal" href="#main-cpp-example-file">main.cpp Example File</a></li>
<li><a class="reference internal" href="#shapedclock-pro-example-file">shapedclock.pro Example File</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" id="q" size="18" />
      <input type="submit" value="Go" id="search_button" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="shaped-clock-example">
<span id="id1"></span><h1>Shaped Clock Example<a class="headerlink" href="#shaped-clock-example" title="Permalink to this headline">¶</a></h1>
<p>Shaped Clock example shows how to apply a widget mask to a top-level widget to produce a shaped window</p>
<blockquote>
<div><p>The Shaped Clock example shows how to apply a widget mask to a top-level widget to produce a shaped window.</p>
<p>Widget masks are used to customize the shapes of top-level widgets by restricting the available area for painting. On some window systems, setting certain window flags will cause the window decoration (title bar, window frame, buttons) to be disabled, allowing specially-shaped windows to be created. In this example, we use this feature to create a circular window containing an analog clock.</p>
<p>Since this example’s window does not provide a File menu or a close button, we provide a context menu with an Exit entry so that the example can be closed. Click the right mouse button over the window to open this menu.</p>
</div></blockquote>
<div class="section" id="shapedclock-class-definition">
<span id="id2"></span><h2>ShapedClock Class Definition<a class="headerlink" href="#shapedclock-class-definition" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The <code class="docutils literal"><span class="pre">ShapedClock</span></code> class is based on the <code class="docutils literal"><span class="pre">AnalogClock</span></code> class defined in the <a class="reference internal" href="qtwidgets-widgets-analogclock-example.html#analog-clock-example"><span class="std std-ref">Analog Clock</span></a> example. The whole class definition is presented below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ShapedClock</span> <span class="p">:</span> <span class="n">public</span> <span class="n">QWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>

<span class="n">public</span><span class="p">:</span>
    <span class="n">ShapedClock</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">QSize</span> <span class="n">sizeHint</span><span class="p">()</span> <span class="n">const</span> <span class="n">override</span><span class="p">;</span>

<span class="n">protected</span><span class="p">:</span>
    <span class="n">void</span> <span class="n">mouseMoveEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span> <span class="n">override</span><span class="p">;</span>
    <span class="n">void</span> <span class="n">mousePressEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span> <span class="n">override</span><span class="p">;</span>
    <span class="n">void</span> <span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span> <span class="n">override</span><span class="p">;</span>
    <span class="n">void</span> <span class="n">resizeEvent</span><span class="p">(</span><span class="n">QResizeEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span> <span class="n">override</span><span class="p">;</span>

<span class="n">private</span><span class="p">:</span>
    <span class="n">QPoint</span> <span class="n">dragPosition</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The <code class="xref py py-func docutils literal"><span class="pre">QWidget.paintEvent()</span></code> implementation is the same as that found in the <code class="docutils literal"><span class="pre">AnalogClock</span></code> class. We implement <code class="xref py py-func docutils literal"><span class="pre">QWidget.sizeHint()</span></code> so that we don’t have to resize the widget explicitly. We also provide an event handler for resize events. This allows us to update the mask if the clock is resized.</p>
<p>Since the window containing the clock widget will have no title bar, we provide implementations for <code class="xref py py-func docutils literal"><span class="pre">QWidget.mouseMoveEvent()</span></code> and <code class="xref py py-func docutils literal"><span class="pre">QWidget.mousePressEvent()</span></code> to allow the clock to be dragged around the screen. The <code class="docutils literal"><span class="pre">dragPosition</span></code> variable lets us keep track of where the user last clicked on the widget.</p>
</div></blockquote>
</div>
<div class="section" id="shapedclock-class-implementation">
<span id="id3"></span><h2>ShapedClock Class Implementation<a class="headerlink" href="#shapedclock-class-implementation" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The <code class="docutils literal"><span class="pre">ShapedClock</span></code> constructor performs many of the same tasks as the <code class="docutils literal"><span class="pre">AnalogClock</span></code> constructor. We set up a timer and connect it to the widget’s update() slot:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ShapedClock</span><span class="p">::</span><span class="n">ShapedClock</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span>
    <span class="p">:</span> <span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">Qt</span><span class="p">::</span><span class="n">FramelessWindowHint</span> <span class="o">|</span> <span class="n">Qt</span><span class="p">::</span><span class="n">WindowSystemMenuHint</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QTimer</span> <span class="o">*</span><span class="n">timer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">QTimer</span><span class="p">(</span><span class="n">this</span><span class="p">);</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">timer</span><span class="p">,</span> <span class="n">SIGNAL</span><span class="p">(</span><span class="n">timeout</span><span class="p">()),</span> <span class="n">this</span><span class="p">,</span> <span class="n">SLOT</span><span class="p">(</span><span class="n">update</span><span class="p">()));</span>
    <span class="n">timer</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>

    <span class="n">QAction</span> <span class="o">*</span><span class="n">quitAction</span> <span class="o">=</span> <span class="n">new</span> <span class="n">QAction</span><span class="p">(</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;E&amp;xit&quot;</span><span class="p">),</span> <span class="n">this</span><span class="p">);</span>
    <span class="n">quitAction</span><span class="o">-&gt;</span><span class="n">setShortcut</span><span class="p">(</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Ctrl+Q&quot;</span><span class="p">));</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">quitAction</span><span class="p">,</span> <span class="n">SIGNAL</span><span class="p">(</span><span class="n">triggered</span><span class="p">()),</span> <span class="n">qApp</span><span class="p">,</span> <span class="n">SLOT</span><span class="p">(</span><span class="n">quit</span><span class="p">()));</span>
    <span class="n">addAction</span><span class="p">(</span><span class="n">quitAction</span><span class="p">);</span>

    <span class="n">setContextMenuPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="p">::</span><span class="n">ActionsContextMenu</span><span class="p">);</span>
    <span class="n">setToolTip</span><span class="p">(</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Drag the clock with the left mouse button.</span><span class="se">\n</span><span class="s2">&quot;</span>
                  <span class="s2">&quot;Use the right mouse button to open a context menu.&quot;</span><span class="p">));</span>
    <span class="n">setWindowTitle</span><span class="p">(</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Shaped Analog Clock&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We inform the window manager that the widget is not to be decorated with a window frame by setting the <code class="xref py py-attr docutils literal"><span class="pre">Qt.FramelessWindowHint</span></code> flag on the widget. As a result, we need to provide a way for the user to move the clock around the screen.</p>
<p>Mouse button events are delivered to the <code class="docutils literal"><span class="pre">mousePressEvent()</span></code> handler:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">ShapedClock</span><span class="p">::</span><span class="n">mousePressEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="p">::</span><span class="n">LeftButton</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">dragPosition</span> <span class="o">=</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">globalPos</span><span class="p">()</span> <span class="o">-</span> <span class="n">frameGeometry</span><span class="p">()</span><span class="o">.</span><span class="n">topLeft</span><span class="p">();</span>
        <span class="n">event</span><span class="o">-&gt;</span><span class="n">accept</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If the left mouse button is pressed over the widget, we record the displacement in global (screen) coordinates between the top-left position of the widget’s frame (even when hidden) and the point where the mouse click occurred. This displacement will be used if the user moves the mouse while holding down the left button. Since we acted on the event, we accept it by calling its <code class="xref py py-func docutils literal"><span class="pre">QEvent.accept()</span></code> function.</p>
<p>The <code class="docutils literal"><span class="pre">mouseMoveEvent()</span></code> handler is called if the mouse is moved over the widget.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">ShapedClock</span><span class="p">::</span><span class="n">mouseMoveEvent</span><span class="p">(</span><span class="n">QMouseEvent</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">buttons</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="p">::</span><span class="n">LeftButton</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">move</span><span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">globalPos</span><span class="p">()</span> <span class="o">-</span> <span class="n">dragPosition</span><span class="p">);</span>
        <span class="n">event</span><span class="o">-&gt;</span><span class="n">accept</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If the left button is held down while the mouse is moved, the top-left corner of the widget is moved to the point given by subtracting the <code class="docutils literal"><span class="pre">dragPosition</span></code> from the current cursor position in global coordinates. If we drag the widget, we also accept the event.</p>
<p>The <code class="docutils literal"><span class="pre">paintEvent()</span></code> function is given for completeness. See the <a class="reference internal" href="qtwidgets-widgets-analogclock-example.html#analog-clock-example"><span class="std std-ref">Analog Clock</span></a> example for a description of the process used to render the clock.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">ShapedClock</span><span class="p">::</span><span class="n">paintEvent</span><span class="p">(</span><span class="n">QPaintEvent</span> <span class="o">*</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">static</span> <span class="n">const</span> <span class="n">QPoint</span> <span class="n">hourHand</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">QPoint</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="n">QPoint</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="n">QPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">)</span>
    <span class="p">};</span>
    <span class="n">static</span> <span class="n">const</span> <span class="n">QPoint</span> <span class="n">minuteHand</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">QPoint</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="n">QPoint</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="n">QPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">70</span><span class="p">)</span>
    <span class="p">};</span>

    <span class="n">QColor</span> <span class="n">hourColor</span><span class="p">(</span><span class="mi">127</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">127</span><span class="p">);</span>
    <span class="n">QColor</span> <span class="n">minuteColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">191</span><span class="p">);</span>

    <span class="nb">int</span> <span class="n">side</span> <span class="o">=</span> <span class="n">qMin</span><span class="p">(</span><span class="n">width</span><span class="p">(),</span> <span class="n">height</span><span class="p">());</span>
    <span class="n">QTime</span> <span class="n">time</span> <span class="o">=</span> <span class="n">QTime</span><span class="p">::</span><span class="n">currentTime</span><span class="p">();</span>

    <span class="n">QPainter</span> <span class="n">painter</span><span class="p">(</span><span class="n">this</span><span class="p">);</span>
    <span class="n">painter</span><span class="o">.</span><span class="n">setRenderHint</span><span class="p">(</span><span class="n">QPainter</span><span class="p">::</span><span class="n">Antialiasing</span><span class="p">);</span>
    <span class="n">painter</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
    <span class="n">painter</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">side</span> <span class="o">/</span> <span class="mf">200.0</span><span class="p">,</span> <span class="n">side</span> <span class="o">/</span> <span class="mf">200.0</span><span class="p">);</span>

    <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">Qt</span><span class="p">::</span><span class="n">NoPen</span><span class="p">);</span>
    <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">hourColor</span><span class="p">);</span>

    <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">();</span>
    <span class="n">painter</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mf">30.0</span> <span class="o">*</span> <span class="p">((</span><span class="n">time</span><span class="o">.</span><span class="n">hour</span><span class="p">()</span> <span class="o">+</span> <span class="n">time</span><span class="o">.</span><span class="n">minute</span><span class="p">()</span> <span class="o">/</span> <span class="mf">60.0</span><span class="p">)));</span>
    <span class="n">painter</span><span class="o">.</span><span class="n">drawConvexPolygon</span><span class="p">(</span><span class="n">hourHand</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
    <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">();</span>

    <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">hourColor</span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawLine</span><span class="p">(</span><span class="mi">88</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mf">30.0</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">Qt</span><span class="p">::</span><span class="n">NoPen</span><span class="p">);</span>
    <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">minuteColor</span><span class="p">);</span>

    <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">();</span>
    <span class="n">painter</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mf">6.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">minute</span><span class="p">()</span> <span class="o">+</span> <span class="n">time</span><span class="o">.</span><span class="n">second</span><span class="p">()</span> <span class="o">/</span> <span class="mf">60.0</span><span class="p">));</span>
    <span class="n">painter</span><span class="o">.</span><span class="n">drawConvexPolygon</span><span class="p">(</span><span class="n">minuteHand</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
    <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">();</span>

    <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">minuteColor</span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">j</span> <span class="o">%</span> <span class="mi">5</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawLine</span><span class="p">(</span><span class="mi">92</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mf">6.0</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the <code class="docutils literal"><span class="pre">resizeEvent()</span></code> handler, we re-use some of the code from the <code class="docutils literal"><span class="pre">paintEvent()</span></code> to determine the region of the widget that is visible to the user:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">ShapedClock</span><span class="p">::</span><span class="n">resizeEvent</span><span class="p">(</span><span class="n">QResizeEvent</span> <span class="o">*</span> <span class="o">/*</span> <span class="n">event</span> <span class="o">*/</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nb">int</span> <span class="n">side</span> <span class="o">=</span> <span class="n">qMin</span><span class="p">(</span><span class="n">width</span><span class="p">(),</span> <span class="n">height</span><span class="p">());</span>
    <span class="n">QRegion</span> <span class="n">maskedRegion</span><span class="p">(</span><span class="n">width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">side</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">side</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">side</span><span class="p">,</span>
                         <span class="n">side</span><span class="p">,</span> <span class="n">QRegion</span><span class="p">::</span><span class="n">Ellipse</span><span class="p">);</span>
    <span class="n">setMask</span><span class="p">(</span><span class="n">maskedRegion</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Since the clock face is a circle drawn in the center of the widget, this is the region we use as the mask.</p>
<p>Although the lack of a window frame may make it difficult for the user to resize the widget on some platforms, it will not necessarily be impossible. The <code class="docutils literal"><span class="pre">resizeEvent()</span></code> function ensures that the widget mask will always be updated if the widget’s dimensions change, and additionally ensures that it will be set up correctly when the widget is first displayed.</p>
<p>Finally, we implement the <code class="docutils literal"><span class="pre">sizeHint()</span></code> for the widget so that it is given a reasonable default size when it is first shown:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">QSize</span> <span class="n">ShapedClock</span><span class="p">::</span><span class="n">sizeHint</span><span class="p">()</span> <span class="n">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">QSize</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="notes-on-widget-masks">
<span id="id4"></span><h2>Notes on Widget Masks<a class="headerlink" href="#notes-on-widget-masks" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Since <a class="reference internal" href="../PySide2/QtGui/QRegion.html#PySide2.QtGui.QRegion" title="PySide2.QtGui.QRegion"><code class="xref py py-class docutils literal"><span class="pre">PySide2.QtGui.QRegion</span></code></a> allows arbitrarily complex regions to be created, widget masks can be made to suit the most unconventionally-shaped windows, and even allow widgets to be displayed with holes in them.</p>
<p>Widget masks can also be constructed by using the contents of pixmap to define the opaque part of the widget. For a pixmap with an alpha channel, a suitable mask can be obtained with <code class="xref py py-func docutils literal"><span class="pre">QPixmap.mask()</span></code> .</p>
</div></blockquote>
</div>
</div>
<div class="section" id="shapedclock-cpp-example-file">
<h1>shapedclock.cpp Example File<a class="headerlink" href="#shapedclock-cpp-example-file" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="shapedclock-h-example-file">
<h1>shapedclock.h Example File<a class="headerlink" href="#shapedclock-h-example-file" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="main-cpp-example-file">
<h1>main.cpp Example File<a class="headerlink" href="#main-cpp-example-file" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="shapedclock-pro-example-file">
<h1>shapedclock.pro Example File<a class="headerlink" href="#shapedclock-pro-example-file" title="Permalink to this headline">¶</a></h1>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <p>© 2018 The Qt Company Ltd. Documentation contributions included herein are the copyrights of their respective owners. The documentation provided herein is licensed under the terms of the <a href="http://www.gnu.org/license/fdl.html">GNU Free Documentation License version 1.3</a> as published by the Free Software Foundation. Qt and respective logos are trademarks of The Qt Company Ltd. in Finland and/or other countries worldwide. All other trademarks are property of their respective owners.</p>
    </div></div>
    <div id="footer" class="footer">
    </div>
</div>
  </body>
</html>